{"version":3,"sources":["../../Finance_api/routes/index.js"],"names":["express","require","auth","flash","Expenses","router","Router","use","req","res","next","locals","success_msg","error_msg","error","user","userExpenses","find","id","populate","sort","createdAt","checkLoggedIn","isAuthenticated","redirect","get","render","module","exports"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAC,gBAAD,CAApB;;AACA,MAAME,KAAK,GAAGF,OAAO,CAAC,eAAD,CAArB;;AACA,MAAMG,QAAQ,GAAGH,OAAO,CAAC,oBAAD,CAAxB;;AACA,MAAMI,MAAM,GAAGL,OAAO,CAACM,MAAR,EAAf;AAEAD,MAAM,CAACE,GAAP,CAAW,OAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,KAA0B;AACjCD,EAAAA,GAAG,CAACE,MAAJ,CAAWC,WAAX,GAAyBJ,GAAG,CAACL,KAAJ,CAAU,aAAV,CAAzB;AACAM,EAAAA,GAAG,CAACE,MAAJ,CAAWE,SAAX,GAAuBL,GAAG,CAACL,KAAJ,CAAU,WAAV,CAAvB;AACAM,EAAAA,GAAG,CAACE,MAAJ,CAAWG,KAAX,GAAmBN,GAAG,CAACL,KAAJ,CAAU,OAAV,CAAnB;AACAM,EAAAA,GAAG,CAACE,MAAJ,CAAWI,IAAX,GAAkBP,GAAG,CAACO,IAAJ,IAAY,IAA9B;AACAN,EAAAA,GAAG,CAACE,MAAJ,CAAWK,YAAX,GAA0B,OAAQR,GAAG,CAACO,IAAZ,IAAqB,WAArB,GAAmC,IAAnC,GAA0C,MAAMX,QAAQ,CAACa,IAAT,CAAc;AAAEF,IAAAA,IAAI,EAAEP,GAAG,CAACO,IAAJ,CAASG;AAAjB,GAAd,EAAqCC,QAArC,CAA8C,MAA9C,EAAsDC,IAAtD,CAA2D;AAAEC,IAAAA,SAAS,EAAE,CAAC;AAAd,GAA3D,CAA1E;AACAX,EAAAA,IAAI;AACP,CAPD;;AASA,SAASY,aAAT,CAAuBd,GAAvB,EAA4BC,GAA5B,EAAiCC,IAAjC,EAAuC;AACnC,MAAIF,GAAG,CAACe,eAAJ,EAAJ,EACId,GAAG,CAACe,QAAJ,CAAa,MAAb,EADJ,KAEK;AACDd,IAAAA,IAAI;AACP;AACJ,C,CAED;;;AACAL,MAAM,CAACoB,GAAP,CAAW,GAAX,EAAgB,CAACjB,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAChC,MAAIF,GAAG,CAACe,eAAJ,EAAJ,EAA2B;AACvBd,IAAAA,GAAG,CAACe,QAAJ,CAAa,OAAb;AACH,GAFD,MAEO;AACHf,IAAAA,GAAG,CAACiB,MAAJ,CAAW,OAAX;AACH;AACJ,CAND;AAQArB,MAAM,CAACoB,GAAP,CAAW,SAAX,EAAsBH,aAAtB,EAAqC,CAACd,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AACrDD,EAAAA,GAAG,CAACiB,MAAJ,CAAW,SAAX;AACH,CAFD;AAIArB,MAAM,CAACoB,GAAP,CAAW,MAAX,EAAmB,CAACjB,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AACnCD,EAAAA,GAAG,CAACiB,MAAJ,CAAW,KAAX;AACH,CAFD;AAIArB,MAAM,CAACoB,GAAP,CAAW,OAAX,EAAoBvB,IAApB,EAA0B,CAACM,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC1CD,EAAAA,GAAG,CAACiB,MAAJ,CAAW,MAAX;AACH,CAFD;AAIAC,MAAM,CAACC,OAAP,GAAiBvB,MAAjB","sourcesContent":["const express = require('express');\r\nconst auth = require('../config/auth');\r\nconst flash = require('express-flash');\r\nconst Expenses = require('../models/expenses');\r\nconst router = express.Router();\r\n\r\nrouter.use(async (req, res, next) => {\r\n    res.locals.success_msg = req.flash(\"success_msg\");\r\n    res.locals.error_msg = req.flash(\"error_msg\");\r\n    res.locals.error = req.flash(\"error\");\r\n    res.locals.user = req.user || null;\r\n    res.locals.userExpenses = typeof (req.user) == 'undefined' ? null : await Expenses.find({ user: req.user.id }).populate('user').sort({ createdAt: -1 });\r\n    next();\r\n});\r\n\r\nfunction checkLoggedIn(req, res, next) {\r\n    if (req.isAuthenticated())\r\n        res.redirect('back');\r\n    else {\r\n        next()\r\n    }\r\n}\r\n\r\n// Get index page\r\nrouter.get('/', (req, res, next) => {\r\n    if (req.isAuthenticated()) {\r\n        res.redirect('/home')\r\n    } else {\r\n        res.render('index');\r\n    }\r\n});\r\n\r\nrouter.get('/signup', checkLoggedIn, (req, res, next) => {\r\n    res.render('sign-up');\r\n});\r\n\r\nrouter.get('/faq', (req, res, next) => {\r\n    res.render('faq');\r\n});\r\n\r\nrouter.get('/home', auth, (req, res, next) => {\r\n    res.render('home');\r\n})\r\n\r\nmodule.exports = router;"],"file":"index.js"}