{"version":3,"sources":["../../Finance_api/models/users.js"],"names":["mongoose","require","bcrypt","Schema","userSchema","name","type","String","required","email","unique","password","timestamps","pre","next","user","SALT_FACTOR","isModified","genSalt","err","salt","hash","methods","comparePassword","candidatePassword","cb","compare","isMatch","module","exports","model"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,eAAD,CAAtB;;AACA,MAAME,MAAM,GAAGH,QAAQ,CAACG,MAAxB;AACA,MAAMC,UAAU,GAAG,IAAID,MAAJ,CAAW;AAC5BE,EAAAA,IAAI,EAAE;AACJC,IAAAA,IAAI,EAAEC,MADF;AAEJC,IAAAA,QAAQ,EAAE;AAFN,GADsB;AAK5BC,EAAAA,KAAK,EAAE;AACLH,IAAAA,IAAI,EAAEC,MADD;AAELC,IAAAA,QAAQ,EAAE,IAFL;AAGLE,IAAAA,MAAM,EAAE;AAHH,GALqB;AAU5BC,EAAAA,QAAQ,EAAE;AACRL,IAAAA,IAAI,EAAEC,MADE;AAERC,IAAAA,QAAQ,EAAE;AAFF;AAVkB,CAAX,EAchB;AACDI,EAAAA,UAAU,EAAE;AADX,CAdgB,CAAnB,C,CAkBA;;AACAR,UAAU,CAACS,GAAX,CAAe,MAAf,EAAuB,UAAUC,IAAV,EAAgB;AACrC,MAAIC,IAAI,GAAG,IAAX;AACA,MAAIC,WAAW,GAAG,EAAlB;AAEA,MAAI,CAACD,IAAI,CAACE,UAAL,CAAgB,UAAhB,CAAL,EAAkC,OAAOH,IAAI,EAAX;AAElCZ,EAAAA,MAAM,CAACgB,OAAP,CAAeF,WAAf,EAA4B,UAAUG,GAAV,EAAeC,IAAf,EAAqB;AAC7C,QAAID,GAAJ,EAAS,OAAOL,IAAI,CAACK,GAAD,CAAX;AAETjB,IAAAA,MAAM,CAACmB,IAAP,CAAYN,IAAI,CAACJ,QAAjB,EAA2BS,IAA3B,EAAiC,IAAjC,EAAuC,UAAUD,GAAV,EAAeE,IAAf,EAAqB;AACxD,UAAIF,GAAJ,EAAS,OAAOL,IAAI,CAACK,GAAD,CAAX;AACTJ,MAAAA,IAAI,CAACJ,QAAL,GAAgBU,IAAhB;AACAP,MAAAA,IAAI;AACP,KAJD;AAKH,GARD;AASD,CAfD;;AAiBAV,UAAU,CAACkB,OAAX,CAAmBC,eAAnB,GAAqC,UAAUC,iBAAV,EAA6BC,EAA7B,EAAiC;AACpEvB,EAAAA,MAAM,CAACwB,OAAP,CAAeF,iBAAf,EAAkC,KAAKb,QAAvC,EAAiD,UAAUQ,GAAV,EAAeQ,OAAf,EAAwB;AACrE,QAAIR,GAAJ,EAAS,OAAOM,EAAE,CAACN,GAAD,CAAT;AACTM,IAAAA,EAAE,CAAC,IAAD,EAAOE,OAAP,CAAF;AACH,GAHD;AAID,CALD;;AAOAC,MAAM,CAACC,OAAP,GAAiB7B,QAAQ,CAAC8B,KAAT,CAAe,OAAf,EAAwB1B,UAAxB,CAAjB","sourcesContent":["const mongoose = require('mongoose');\r\nconst bcrypt = require('bcrypt-nodejs');\r\nconst Schema = mongoose.Schema;\r\nconst userSchema = new Schema({\r\n  name: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  email: {\r\n    type: String,\r\n    required: true,\r\n    unique: true\r\n  },\r\n  password: {\r\n    type: String,\r\n    required: true\r\n  },\r\n}, {\r\n  timestamps: true,\r\n});\r\n\r\n//Hash password with bcrypt before saving\r\nuserSchema.pre('save', function (next) {\r\n  var user = this;\r\n  var SALT_FACTOR = 12;\r\n\r\n  if (!user.isModified('password')) return next();\r\n\r\n  bcrypt.genSalt(SALT_FACTOR, function (err, salt) {\r\n      if (err) return next(err);\r\n\r\n      bcrypt.hash(user.password, salt, null, function (err, hash) {\r\n          if (err) return next(err);\r\n          user.password = hash;\r\n          next();\r\n      });\r\n  });\r\n});\r\n\r\nuserSchema.methods.comparePassword = function (candidatePassword, cb) {\r\n  bcrypt.compare(candidatePassword, this.password, function (err, isMatch) {\r\n      if (err) return cb(err);\r\n      cb(null, isMatch);\r\n  });\r\n};\r\n\r\nmodule.exports = mongoose.model('users', userSchema);\r\n"],"file":"users.js"}